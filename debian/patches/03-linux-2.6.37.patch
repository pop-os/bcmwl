Index: broadcom-sta-5.100.82.38/amd64/src/wl/sys/wl_linux.c
===================================================================
--- broadcom-sta-5.100.82.38.orig/amd64/src/wl/sys/wl_linux.c	2011-02-10 09:20:39.386342000 +0400
+++ broadcom-sta-5.100.82.38/amd64/src/wl/sys/wl_linux.c	2011-02-10 09:21:23.494342000 +0400
@@ -484,7 +484,11 @@
 #ifdef WL_ALL_PASSIVE
 		spin_lock_init(&wl->txq_lock);
 #endif 
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(2, 6, 37)
+		sema_init(&wl->sem, 1);
+#else
 		init_MUTEX(&wl->sem);
+#endif
 	}
 
 	if (!(wl->wlc = wlc_attach((void *) wl, vendor, device, unit, wl->piomode,
Index: broadcom-sta-5.100.82.38/i386/src/wl/sys/wl_linux.c
===================================================================
--- broadcom-sta-5.100.82.38.orig/i386/src/wl/sys/wl_linux.c	2011-02-10 09:19:10.246342000 +0400
+++ broadcom-sta-5.100.82.38/i386/src/wl/sys/wl_linux.c	2011-02-10 09:20:27.666342000 +0400
@@ -484,7 +484,11 @@
 #ifdef WL_ALL_PASSIVE
 		spin_lock_init(&wl->txq_lock);
 #endif 
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(2, 6, 37)
+		sema_init(&wl->sem, 1);
+#else
 		init_MUTEX(&wl->sem);
+#endif
 	}
 
 	if (!(wl->wlc = wlc_attach((void *) wl, vendor, device, unit, wl->piomode,
